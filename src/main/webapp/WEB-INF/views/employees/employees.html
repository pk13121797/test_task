<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link th:href="@{/resources/css/home.css}" rel="stylesheet"/>
  <script th:src="@{/resources/js/find.js}" type="text/javascript"></script>
  <title th:text="#{employees.title}">Employees</title>
</head>
<body>
<br>
<div>
  <h2 class="ml" th:text="#{employees.title}">Employees</h2>
</div>
<div class="ml">
  <form th:action="@{/employees}">
    <div class="form-group">
      <div class="col-2">
        <label for="find-employee"></label>
        <input type="text" class="form-control" id="find-employee" name="q">
      </div>
      <button th:text="#{employees.find}" type="submit" class="btn btn-light" onclick="find()" style="margin-top: 10px">Find employees</button>
    </div>
  </form>
</div>
<br>
<th:block th:if="${!employees.isEmpty()}">
  <table class="table">
    <tr>
      <th width="80" th:text="#{employees.id}">Id</th>
      <th width="80" th:text="#{employees.photo}">Photo</th>
      <th width="120">
        <a th:href="@{'/employees/page/' + ${currentPage} + '?sortField=surname&sortDirection=' + ${sortReverse}}" th:text="#{employees.surname}">
          Surname
        </a>
      </th>
      <th width="120">
        <a th:href="@{'/employees/page/' + ${currentPage} + '?sortField=name&sortDirection=' + ${sortReverse}}" th:text="#{employees.name}">
          Name
        </a>
      </th>
      <th width="120">
        <a th:href="@{'/employees/page/' + ${currentPage} + '?sortField=middleName&sortDirection=' + ${sortReverse}}" th:text="#{employees.middleName}">
          Middle name
        </a>
      </th>
      <th width="120">
        <a th:href="@{'/employees/page/' + ${currentPage} + '?sortField=post&sortDirection=' + ${sortReverse}}" th:text="#{employees.post}">
          Post
        </a>
      </th>
      <th width="80" th:text="#{employees.edit}">Edit</th>
      <th width="80" th:text="#{employees.delete}">Delete</th>
    </tr>

    <div th:each="employee : ${employees}">
      <tr>
        <td><b th:text="${employee.getId()}"></b></td>
        <td>
          <th:block th:if="${employee.getImages().isEmpty()}">
            <img th:src="@{/resources/img/static/user.png}"
                 alt="Employee image"
                 id="default-image"
                 width="60"
                 height="50">
          </th:block>
          <th:block th:if="${!employee.getImages().isEmpty()}">
            <img th:src="@{/img/{image}(image = ${employee.getImages().stream().findFirst().orElse(null)})}"
                 alt="Employee image"
                 id="image"
                 width="60"
                 height="50">
          </th:block>
        </td>
        <td><b th:text="${employee.getSurname()}"></b></td>
        <td><b th:text="${employee.getName()}"></b></td>
        <td><b th:text="${employee.getMiddleName()}"></b></td>
        <td><b th:text="${employee.getPost()}"></b></td>
        <td>
          <form th:action="@{/employees/edit/{id}(id=${employee.getId()})}">
            <button type="submit" class="btn btn-link" th:text="#{employees.edit}">Edit</button>
          </form>
        </td>
        <td>
          <form th:action="@{/employees/{id}(id=${employee.getId()})}" th:method="delete">
            <button type="submit" class="btn btn-link" th:text="#{employees.delete}">Delete</button>
          </form>
        </td>
      </tr>
    </div>
  </table>
</th:block>
<br>
<div class="ml" th:if="${totalPages > 1}">
  <nav aria-label="Page navigation">
    <ul class="pagination">
      <li class="page-item">
        <a class="page-link" th:if="${page.hasPrevious()}" th:href="@{'/employees/page/' + ${currentPage - 1} + '?sortField=' + ${sortField} + '&sortDirection=' + ${sortDirection}}" th:text="#{menu.prev}">
          Previous
        </a>
      </li>
      <li th:each="i: ${#numbers.sequence(1,totalPages)}" class="page-item">
        <div class="page-item" th:if="${currentPage != i}">
          <a class="page-link" th:href="@{'/employees/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDirection=' + ${sortDirection}}">[[${i}]]</a>
        </div>
        <div class="page-item active" th:if="${currentPage == i}">
          <a class="page-link" th:href="@{'/employees/page/' + ${i} + '?sortField=' + ${sortField} + '&sortDirection=' + ${sortDirection}}">[[${i}]]</a>
        </div>
      </li>
      <li class="page-item">
        <a class="page-link" th:if="${page.hasNext()}" th:href="@{'/employees/page/' + ${currentPage + 1} + '?sortField=' + ${sortField} + '&sortDirection=' + ${sortDirection}}" th:text="#{menu.next}">
          Next
        </a>
      </li>
    </ul>
  </nav>
</div>
<br>
<div class="ml">
  <form th:action="@{/employees/new}">
    <button class="btn btn-light" th:text="#{employees.add}"> Add employee </button>
  </form> <br>
  <form th:action="@{/}">
    <button class="btn btn-light" th:text="#{menu.back}"> Back to menu </button>
  </form>
</div>
</body>
</html>